{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "ActionParams": {
      "anyOf": [
        {
          "properties": {
            "bucket": {
              "type": "string"
            },
            "data": {
              "additionalProperties": {
                "type": "string"
              },
              "propertyOrder": [],
              "type": "object"
            },
            "filename": {
              "type": "string"
            },
            "input": {
              "enum": ["html"],
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "output": {
              "enum": ["pdf"],
              "type": "string"
            },
            "template": {
              "anyOf": [
                {
                  "properties": {
                    "path": {
                      "type": "string"
                    }
                  },
                  "propertyOrder": ["path"],
                  "required": ["path"],
                  "type": "object"
                },
                {
                  "type": "string"
                }
              ]
            },
            "type": {
              "enum": ["create_file"],
              "type": "string"
            }
          },
          "propertyOrder": [
            "name",
            "type",
            "filename",
            "input",
            "output",
            "template",
            "bucket",
            "data"
          ],
          "required": ["bucket", "data", "filename", "input", "name", "output", "template", "type"],
          "type": "object"
        },
        {
          "properties": {
            "name": {
              "type": "string"
            },
            "recordId": {
              "type": "string"
            },
            "table": {
              "type": "string"
            },
            "type": {
              "enum": ["find_record"],
              "type": "string"
            }
          },
          "propertyOrder": ["name", "type", "table", "recordId"],
          "required": ["name", "recordId", "table", "type"],
          "type": "object"
        },
        {
          "properties": {
            "message": {
              "type": "string"
            },
            "name": {
              "type": "string"
            },
            "type": {
              "enum": ["log"],
              "type": "string"
            }
          },
          "propertyOrder": ["name", "type", "message"],
          "required": ["message", "name", "type"],
          "type": "object"
        },
        {
          "properties": {
            "fields": {
              "additionalProperties": {
                "type": "string"
              },
              "propertyOrder": [],
              "type": "object"
            },
            "name": {
              "type": "string"
            },
            "recordId": {
              "type": "string"
            },
            "table": {
              "type": "string"
            },
            "type": {
              "enum": ["update_record"],
              "type": "string"
            }
          },
          "propertyOrder": ["name", "type", "table", "recordId", "fields"],
          "required": ["fields", "name", "recordId", "table", "type"],
          "type": "object"
        }
      ]
    },
    "FilterParams": {
      "anyOf": [
        {
          "$ref": "#/definitions/IsFilterParams"
        },
        {
          "$ref": "#/definitions/IsAnyOfFilterParams"
        }
      ]
    },
    "IsAnyOfFilterParams": {
      "properties": {
        "field": {
          "type": "string"
        },
        "operator": {
          "enum": ["is_any_of"],
          "type": "string"
        },
        "value": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "propertyOrder": ["operator", "value", "field"],
      "required": ["field", "operator", "value"],
      "type": "object"
    },
    "IsFilterParams": {
      "properties": {
        "field": {
          "type": "string"
        },
        "operator": {
          "enum": ["is"],
          "type": "string"
        },
        "value": {
          "type": "string"
        }
      },
      "propertyOrder": ["operator", "value", "field"],
      "required": ["field", "operator", "value"],
      "type": "object"
    },
    "TriggerParams": {
      "anyOf": [
        {
          "properties": {
            "event": {
              "enum": ["record_created"],
              "type": "string"
            },
            "filters": {
              "items": {
                "$ref": "#/definitions/FilterParams"
              },
              "type": "array"
            },
            "table": {
              "type": "string"
            }
          },
          "propertyOrder": ["event", "table", "filters"],
          "required": ["event", "table"],
          "type": "object"
        },
        {
          "properties": {
            "event": {
              "enum": ["record_updated"],
              "type": "string"
            },
            "fields": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "filters": {
              "items": {
                "$ref": "#/definitions/FilterParams"
              },
              "type": "array"
            },
            "table": {
              "type": "string"
            }
          },
          "propertyOrder": ["event", "table", "fields", "filters"],
          "required": ["event", "table"],
          "type": "object"
        }
      ]
    }
  },
  "properties": {
    "actions": {
      "items": {
        "$ref": "#/definitions/ActionParams"
      },
      "type": "array"
    },
    "name": {
      "type": "string"
    },
    "trigger": {
      "$ref": "#/definitions/TriggerParams"
    }
  },
  "propertyOrder": ["name", "trigger", "actions"],
  "required": ["actions", "name", "trigger"],
  "type": "object"
}
